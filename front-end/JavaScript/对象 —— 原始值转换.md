<h2 id="wL8KT">[<font style="color:rgb(49, 49, 48);">转换规则</font>](https://zh.javascript.info/object-toprimitive#zhuan-huan-gui-ze)</h2>
1. <font style="color:rgb(49, 49, 48);">没有转换为布尔值。所有的对象在布尔上下文（context）中均为</font><font style="color:rgb(49, 49, 48);"> </font>`true`<font style="color:rgb(49, 49, 48);">，就这么简单。只有字符串和数字转换。</font>
2. <font style="color:rgb(49, 49, 48);">数字转换发生在对象相减或应用数学函数时。例如，</font>`Date`<font style="color:rgb(49, 49, 48);"> </font><font style="color:rgb(49, 49, 48);">对象（将在</font><font style="color:rgb(49, 49, 48);"> </font>[<font style="color:rgb(49, 49, 48);">日期和时间</font>](https://zh.javascript.info/date)<font style="color:rgb(49, 49, 48);"> </font><font style="color:rgb(49, 49, 48);">一章中介绍）可以相减，</font>`date1 - date2`<font style="color:rgb(49, 49, 48);"> </font><font style="color:rgb(49, 49, 48);">的结果是两个日期之间的差值。</font>
3. <font style="color:rgb(49, 49, 48);">至于字符串转换 —— 通常发生在我们像 </font>`alert(obj)`<font style="color:rgb(49, 49, 48);"> 这样输出一个对象和类似的上下文中。</font>

<h2 id="hC5Rm">[<font style="color:rgb(49, 49, 48);">hint</font>](https://zh.javascript.info/object-toprimitive#hint)</h2>
**<font style="color:rgb(113, 111, 110);background-color:rgb(247, 244, 243);">"string"</font>**

+ `toString`<font style="color:rgb(49, 49, 48);"> </font><font style="color:rgb(49, 49, 48);">方法返回一个字符串</font><font style="color:rgb(49, 49, 48);"> </font>`"[object Object]"`<font style="color:rgb(49, 49, 48);">。</font>
+ `valueOf`<font style="color:rgb(49, 49, 48);"> 方法返回对象自身。</font>
+ <font style="color:rgb(49, 49, 48);">  
</font>

```javascript
// 输出
alert(obj);

// 将对象作为属性键
anotherObj[obj] = 123;
```

`**"number"**`

<font style="color:rgb(49, 49, 48);">对象到数字的转换  
</font><font style="color:rgb(49, 49, 48);"> </font>

```javascript
// 显式转换
let num = Number(obj);

// 数学运算（除了二元加法）
let n = +obj; // 一元加法
let delta = date1 - date2;

// 小于/大于的比较
let greater = user1 > user2;
```

**<font style="color:rgb(113, 111, 110);background-color:rgb(247, 244, 243);">"default"</font>**<font style="color:rgb(49, 49, 48);">  
</font><font style="color:rgb(49, 49, 48);"> </font>

```javascript
// 二元加法使用默认 hint
let total = obj1 + obj2;

// obj == number 使用默认 hint
if (user == 1) { ... };
```

**<font style="color:rgb(49, 49, 48);">为了进行转换，JavaScript 尝试查找并调用三个对象方法：</font>**<font style="color:rgb(49, 49, 48);">  
</font><font style="color:rgb(49, 49, 48);"> </font>

<h2 id="Z9wRr">[<font style="color:rgb(49, 49, 48);">Symbol.toPrimitive</font>](https://zh.javascript.info/object-toprimitive#symboltoprimitive)</h2>
```javascript
obj[Symbol.toPrimitive] = function(hint) {
  // 这里是将此对象转换为原始值的代码
  // 它必须返回一个原始值
  // hint = "string"、"number" 或 "default" 中的一个
}
```

  
 

```plain
let user = {name: "John"};

alert(user); // [object Object]
alert(user.valueOf() === user); // true
```

```javascript
let user = {
    name: "John",
    money: 1000,
  
    // 对于 hint="string"
    toString() {
      return `{name: "${this.name}"}`;
    },
  
    // 对于 hint="number" 或 "default"
    valueOf() {
      return this.money;
    }
  
  };
  
  console.log(user); // toString -> {name: "John"}
//   {
//     name: 'John',
//     money: 1000,
//     toString: [Function: toString],
//     valueOf: [Function: valueOf]
//   }
  console.log(+user); // valueOf -> 1000
  console.log(user + 500); // valueOf -> 1500
```

<font style="color:rgb(49, 49, 48);">  
</font><font style="color:rgb(49, 49, 48);"> </font>

<h2 id="BEwV7">[<font style="color:rgb(49, 49, 48);">toString/valueOf</font>](https://zh.javascript.info/object-toprimitive#tostringvalueof)</h2>
```javascript
let user = {name: "John"};

console.log(user); // [object Object],{ name: 'John' }
console.log(user.valueOf() === user); // true
```

<h2 id="y8DBr">[<font style="color:rgb(49, 49, 48);">进一步的转换</font>](https://zh.javascript.info/object-toprimitive#jin-yi-bu-de-zhuan-huan)</h2>
<font style="color:rgb(49, 49, 48);">许多运算符和函数执行类型转换，例如乘法 </font>`*`<font style="color:rgb(49, 49, 48);"> 将操作数转换为数字。</font>

```javascript
let obj = {
    // toString 在没有其他方法的情况下处理所有转换
    toString() {
      return "2";
    }
  };
  
  console.log(obj * 2); // 4，对象被转换为原始值字符串 "2"，之后它被乘法转换为数字 2。
```

<h2 id="GATXk">[<font style="color:rgb(49, 49, 48);">总结</font>](https://zh.javascript.info/object-toprimitive#zong-jie)</h2>
+ `"string"`<font style="color:rgb(49, 49, 48);">（对于</font><font style="color:rgb(49, 49, 48);"> </font>`alert`<font style="color:rgb(49, 49, 48);"> </font><font style="color:rgb(49, 49, 48);">和其他需要字符串的操作）</font>
+ `"number"`<font style="color:rgb(49, 49, 48);">（对于数学运算）</font>
+ `"default"`<font style="color:rgb(49, 49, 48);">（少数运算符，通常对象以和 </font>`"number"`<font style="color:rgb(49, 49, 48);"> 相同的方式实现 </font>`"default"`<font style="color:rgb(49, 49, 48);"> 转换）</font>

转换算法是：

调用 obj[Symbol.toPrimitive](hint) 如果这个方法存在，  
否则，如果 hint 是 "string"  
尝试调用 obj.toString() 或 obj.valueOf()，无论哪个存在。  
否则，如果 hint 是 "number" 或者 "default"  
尝试调用 obj.valueOf() 或 obj.toString()，无论哪个存在。

